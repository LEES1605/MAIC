# ========================== [03] sha-helper.yml â€” START ==========================
name: Tools â€¢ SHA Helper

on:
  workflow_dispatch:
    inputs:
      path:
        description: "SHAë¥¼ êµ¬í•  íŒŒì¼ ê²½ë¡œ (ì˜ˆ: src/ui/header.py)"
        required: true
        type: string
      ref:
        description: "ê¸°ì¤€ ë¸Œëžœì¹˜/ë¦¬ë¹„ì „ (ì˜ˆ: main)"
        required: false
        default: "main"
        type: string

permissions:
  contents: read

jobs:
  compute-sha:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ§° Checkout (full history)
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ðŸ”¢ Compute SHA256
        id: sha
        env:
          PATH_INPUT: ${{ inputs.path }}
          REF_INPUT: ${{ inputs.ref }}
        run: |
          set -euo pipefail
          git fetch origin "${REF_INPUT}" || true
          if ! git show "origin/${REF_INPUT}:${PATH_INPUT}" >/dev/null 2>&1; then
            echo "::error::origin/${REF_INPUT} ì—ì„œ ${PATH_INPUT} ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
            exit 1
          fi
          CONTENT="$(git show "origin/${REF_INPUT}:${PATH_INPUT}")"
          SHA=$(printf "%s" "$CONTENT" | sha256sum | awk '{print $1}')
          echo "sha256=$SHA" >> "$GITHUB_OUTPUT"

      - name: ðŸ“ Summary
        run: |
          echo "### SHA256 for \`${{ inputs.path }}\` @ \`${{ inputs.ref }}\`" >> $GITHUB_STEP_SUMMARY
          echo "\`${{ steps.sha.outputs.sha256 }}\`" >> $GITHUB_STEP_SUMMARY
# ========================== [03] sha-helper.yml â€” END ============================
