name: ci

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # ===== [01] CHECKOUT ====================================================
      - name: Checkout
        uses: actions/checkout@v4

      # ===== [02] PYTHON SETUP ===============================================
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
          cache: "pip"

      # ===== [03] INSTALL RUNTIME & DEV TOOLS =================================
      - name: Upgrade pip/setuptools/wheel
        run: |
          python -m pip install --upgrade pip setuptools wheel

      - name: Install package (editable)
        run: |
          pip install -e .

      - name: Install dev tools
        run: |
          pip install \
            mypy ruff bandit pytest \
            types-requests types-PyYAML

      # ===== [04] RUFF (LINT & FORMAT CHECK) ==================================
      - name: Ruff - lint
        run: ruff check .

      - name: Ruff - format check
        run: ruff format --check .

      # ===== [05] MYPY ========================================================
      - name: Mypy
        run: mypy .

      # ===== [06] BANDIT (SECURITY) ==========================================
      - name: Bandit
        run: bandit -q -r .

      # ===== [07] TESTS (옵션) ===============================================
      - name: PyTest (optional)
        run: pytest -q || true
