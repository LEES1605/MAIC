# AI Rules
## AI 어시스턴트를 위한 명확한 규칙

⚠️ **CRITICAL: 모든 코드 생성 전 필수 검증**
1. 이 문서를 반드시 읽고 확인하세요
2. 포트 사용 규칙을 확인하세요
3. 규칙 위반 시 실행을 중단하세요
4. 사용자에게 수정 방안을 제안하세요

### 🚫 절대 금지 사항
- **루트에 app.py 외의 새 파일 생성 금지**
  - 모든 새 Python 파일은 `src/` 디렉토리에만 생성
  - 루트에 `test_*.py`, `simple_*.py`, `*_neumorphism.py` 등 생성 금지
- **legacy/ 디렉토리 파일 수정 금지**
  - `legacy/` 디렉토리의 파일은 절대 건드리지 마세요
- **src/ 외부에 기능 코드 생성 금지**
  - UI 컴포넌트: `src/ui/` 에만 생성
  - 비즈니스 로직: `src/application/` 에만 생성
  - 도메인 모델: `src/domain/` 에만 생성

### ✅ 필수 사항
- **모든 새 코드는 src/ 디렉토리에 생성**
  - 파일명은 `snake_case` 사용
  - 의미있는 이름으로 명명
- **app.py는 단순한 진입점만 유지**
  - 복잡한 로직은 `src/` 내부로 이동
  - import만 하고 실제 구현은 `src/` 내부에서
- **중복 구현 방지**
  - 새 파일 생성 전 기존 파일 확인 필수
  - 비슷한 기능이 있으면 기존 파일 수정 또는 통합

### 📁 올바른 프로젝트 구조
```
MAIC/
├── app.py              ← 유일한 메인 진입점
├── src/                ← 모든 실제 구현
│   ├── ui/            ← UI 컴포넌트
│   ├── application/   ← 비즈니스 로직
│   ├── domain/        ← 도메인 모델
│   └── infrastructure/ ← 인프라 코드
├── legacy/            ← 건드리지 마세요
├── docs/              ← 문서들
└── tools/             ← 도구들
```

### 🎯 UI 코드 통합 규칙
- **현재 문제**: 루트에 흩어진 UI 파일들
  - `working_neumorphism.py`
  - `maic_simple_neumorphism.py`
  - `simple_neumorphism.py`
  - `ultimate_neumorphism.py`
  - `neumorphism_elements.py`
  - `neumorphism_app.html`
- **해결 방안**: 
  1. 올바른 UI 파일 식별
  2. `src/ui/` 로 이동
  3. 중복 파일들 삭제
  4. `app.py`에서 올바른 UI 호출

### 🔍 기존 코드 관리 규칙 (안전 버전)

#### ✅ 필수 검사
- **새 코드 작성 전 기존 중복 코드 식별**
  - 비슷한 기능의 파일이 있는지 확인
  - 파일명이나 내용이 중복되는지 검사
  - 의존성 관계 분석
- **중복 코드 목록을 사용자에게 보고**
  - 발견된 중복 파일들 목록 제시
  - 각 파일의 용도와 차이점 설명
  - 삭제 시 영향도 분석 결과 제공

#### 🚫 절대 금지
- **사용자 승인 없이 기존 코드 삭제 금지**
  - 어떤 이유로든 자동 삭제 금지
  - "정리" 목적으로도 삭제 금지
- **의존성 분석 없이 파일 삭제 금지**
  - 다른 파일에서 import하는지 확인 필수
  - 참조 관계 분석 후 삭제 제안
- **백업 생성 없이 삭제 작업 금지**
  - 삭제 전 반드시 `legacy/`로 이동
  - 복구 가능한 상태로 보관

#### 📋 안전한 삭제 프로세스 (사용자 승인 필수)
1. **중복 코드 식별 및 보고**
   ```
   발견된 중복 파일:
   - file1.py: 용도 설명
   - file2.py: 용도 설명
   삭제 제안 및 이유: ...
   ```
2. **의존성 분석 및 영향도 평가**
   ```
   영향받는 파일들:
   - import하는 파일들
   - 참조하는 코드들
   예상 영향: ...
   ```
3. **백업 생성**
   ```
   legacy/ 디렉토리로 이동하여 백업
   ```
4. **사용자 명시적 승인**
   ```
   "정말로 삭제하시겠습니까? (yes/no)"
   ```
5. **안전한 삭제 실행**
   ```
   승인 후에만 삭제 실행
   ```

### 🔧 자동 검증 시스템
- **코드 생성 전 필수 검증**
  - 중복 파일 존재 여부 확인
  - 올바른 디렉토리 위치 확인
  - 명명 규칙 준수 확인
- **사용자 승인 후 적용**
  - 검증 결과를 사용자에게 보고
  - 승인 받은 후에만 코드 생성/수정

### 🌐 로컬 테스트 포트 규칙 (강제 적용)

#### ✅ 표준 사용법
- **기본 포트**: 항상 8501 사용
- **명령어**: `streamlit run app.py` (포트 지정 없이)
- **사용자 안내**: "http://localhost:8501에서 확인하세요"

#### 🚫 절대 금지
- **8501 외의 포트 사용 금지**: 8502, 8503, 8520 등 사용 금지
- **포트 지정 명령어 금지**: `--server.port` 옵션 사용 금지
- **임의 포트 생성 금지**: AI가 임의로 포트 번호 생성 금지

#### 🔄 포트 충돌 시 대안 (예외적 허용)
- 8501 사용 불가 → 사용자에게 충돌 상황 보고
- 사용자 승인 후 → 8502 시도
- 최대 8510까지 시도 (사용자 승인 필수)

#### 📋 포트 사용 체크리스트 (필수)
- [ ] 기본 포트 8501 사용했는가?
- [ ] 사용자에게 올바른 URL을 안내했는가?
- [ ] 포트 충돌 시에만 다른 포트 사용했는가?
- [ ] 사용자 승인을 받았는가?

### 📋 체크리스트 (코드 생성 전)
- [ ] `src/` 디렉토리에 생성하는가?
- [ ] 기존 중복 파일이 없는가?
- [ ] 파일명이 `snake_case`인가?
- [ ] `legacy/` 디렉토리를 건드리지 않는가?
- [ ] `app.py`를 단순하게 유지하는가?
- [ ] 기존 중복 코드를 식별하고 보고했는가?
- [ ] 사용자 승인을 받았는가?
- [ ] 의존성 분석을 완료했는가?
- [ ] 백업을 생성했는가?
- [ ] **포트 사용 규칙을 확인했는가?** (필수)

---
## 관련 문서
- [PROJECT_STRUCTURE.md](PROJECT_STRUCTURE.md) - 프로젝트 구조 상세
- [CURRENT_STATUS.md](CURRENT_STATUS.md) - 현재 상태
- [NEXT_ACTIONS.md](NEXT_ACTIONS.md) - 다음 작업
- [DEVELOPMENT_HISTORY.md](DEVELOPMENT_HISTORY.md) - 개발 과정 기록

