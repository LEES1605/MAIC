# 협의규약 — 진행 보고 & 실행 검증 규칙 (2025‑09‑17)

## 목적
계획(Plan)의 각 파트(Part)가 완료될 때마다 남은 브랜치 수를 명확히 보고하고, 즉시 앱 실행/기능 검증을 수행해 품질을 보증한다.

## 용어
- **Plan**: 상위 목표 묶음(예: CI 가속/안정화).
- **Part**: Plan을 이루는 실질 작업 단위(여러 브랜치를 포함할 수 있음).
- **Branch**: 하나의 원자적 변경 묶음(한 브랜치 = 한 주제).

## 규칙 A — 파트 종료 보고(브랜치 기준)
- 파트의 마지막 브랜치가 머지되면 즉시 아래 형식으로 보고한다.
  - **[남은 브랜치 수]**: `<해당 Plan 전체 예정 브랜치 수> − <지금까지 머지된 브랜치 수>`
  - **상태표**(예시)

    | Plan | Part | 브랜치 | 상태 |
    |---|---|---|---|
    | CI 속도·안정화(2025‑09) | pip 캐시 키 일관화 | `ci/pip-cache-keys-20250917-b1` | ✅ 머지 |
    | CI 속도·안정화(2025‑09) | 릴리즈 아티팩트 안정화 | `ci/release-artifacts-fix-20250917-b0` | ⏳ 대기/리뷰 |
    | CI 속도·안정화(2025‑09) | 빠른 피드백(병렬·캐시·스킵) | `ci/fast-feedback-20250917-b0` | ⏳ 대기/리뷰 |

- 보고에는 **완료(✅)/대기(⏳)/보류(🛑)** 중 하나로 표시한다.

## 규칙 B — 파트 종료 시 앱 실행 & 기능 검증
- **원칙**: Actions‑only 기준으로 자동화된 **Smoke 검증**을 우선하며, UI가 필요한 경우에만 로컬 대안을 안내한다.
- **검증 매트릭스**

  | 변경 유형 | 기본 검증(Actions) | 선택 검증(로컬 대안) |
  |---|---|---|
  | **앱 기능/로직** | `python - <<'PY' ... PY` 스모크 스니펫 + 단위 테스트 | `PYTHONPATH=src streamlit run app.py --server.headless true` 후 수동 확인 |
  | **CI/빌드 배포** | 워크플로 성공 + 아티팩트/태그 확인 | 필요 시 동일 스크립트 로컬 재현 |

### A. 스모크(예: 라벨 SSOT 기능)
```bash
export PYTHONPATH=src
python - <<'PY'
from src.rag.labels import canon_label
assert canon_label("[문법책]") == "[문법서적]"
assert canon_label("[문법서]") == "[문법서적]"
print("Label SSOT OK")
PY
